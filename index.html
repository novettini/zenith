<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Zennith</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    />
    <link rel="stylesheet" href="./styles/footer.css">
    <link rel="stylesheet" href="./styles/home.css" />
    <link rel="stylesheet" href="./styles/cards.css" />
    <link rel="stylesheet" href="./styles/carrousel.css" />
    <link rel="stylesheet" href="./screens/styles/cart.css">
  </head>
  <body>
    <header>
      <!--Barra de navegacion -->
      <div class="container-fluid p-1">
        <div class="row d-flex justify-content-between">
          <div class="p-1 position-static">
            <nav class="navbar navbar-expand-xl navbar-light">
              <div class="container-fluid">
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" 
                data-bs-target="#nav-toggler" aria-controls="navbarTogglerDemo01" aria-expanded="false" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse justify-content-between container-fluid" id="nav-toggler">
                  <a class="navbar-brand" href="#">
                    <img src="src/atomo/logo_zenith.svg" width="75" alt="Logo de Zenith">
                  </a>
                  <!--Acordion-->
                  <ul class="navbar-nav d-flex justify-content-center">
                    <li class="nav-item">
                      <div id="userStatus"></div>
                    </li>
                    <li class="nav-item justify-content-evenly">
                  <p class="d-flex flex-wrap align-items-center justify-content-between m-0">Calzados<a class="nav-link active" aria-current="page" href="./screens/productos.html">Ver Todo</a></p>
                    </li> 
                    <li class="nav-item">
                      <div class="accordion" id="accordionPanelsStayOpenExample">
                        <div class="accordion-item">
                          <h2 class="accordion-header">
                            <button class="accordion-button bg-white shadow-none" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseOne" aria-expanded="true" aria-controls="panelsStayOpen-collapseOne">
                              <p class="accordion-text">Hombre</p>
                            </button>
                          </h2>
                          <div id="panelsStayOpen-collapseOne" class="accordion-collapse collapse show">
                            <div class="accordion-body">
                              <div class="list-group align-items-center">
                                <a href="./screens/productos.html?query=casuales" id="casual" class="list-group-item list-group">Zapatos Casuales</a>
                                <a href="./screens/productos.html?query=vestir"  class="list-group-item list-group">Zapatos de Vestir</a>
                                <a href="./screens/productos.html?query=botines"  class="list-group-item list-group">Botas y Botines</a>
                                <a href="./screens/productos.html?query=urbanas"  class="list-group-item list-group">Zapatillas Urbanas</a>
                                <a href="#" class="list-group-item list-group">Ver todo Hombre</a>
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="accordion-item">
                          <h2 class="accordion-header">
                            <button class="accordion-button collapsed bg-white shadow-none" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseTwo" aria-expanded="false" aria-controls="panelsStayOpen-collapseTwo">
                              <p class="accordion-text">Mujer</p>
                            </button>
                          </h2>
                          <div id="panelsStayOpen-collapseTwo" class="accordion-collapse collapse">
                            <div class="accordion-body">
                              <div class="list-group align-items-center">
                                <a href="#" class="list-group-item list-group">Zapatos Mujer</a>
                                <a href="#" class="list-group-item list-group">Botas y Botines</a>
                                <a href="#" class="list-group-item list-group">Sandalias</a>
                                <a href="#" class="list-group-item list-group">Zapatillas Urbanas</a>
                                <a href="#" class="list-group-item list-group">Zapatillas Deportivas</a>
                                <a href="#" class="list-group-item list-group">Ver todo Mujer</a>
                            </div>
                          </div>
                        </div>
                        <div class="accordion-item">
                          <h2 class="accordion-header">
                            <button class="accordion-button collapsed bg-white shadow-none" type="button"
                              data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseThree"
                              aria-expanded="false" aria-controls="panelsStayOpen-collapseThree">
                              <p class="accordion-text">Niño</p>
                            </button>
                          </h2>
                          <div id="panelsStayOpen-collapseThree" class="accordion-collapse collapse">
                            <div class="accordion-body">
                              <div class="list-group align-items-center">
                                <a href="#" class="list-group-item list-group">Zapatos Niños</a>
                                <a href="#" class="list-group-item list-group">Zapatos Niñas</a>
                                <a href="#" class="list-group-item list-group">Zapatos Bebé</a>
                                <a href="#" class="list-group-item list-group">Zapatillas</a>
                                <a href="#" class="list-group-item list-group">Sandalias</a>
                                <a href="#" class="list-group-item list-group">Ver todo Niños</a>
                              </div>
                            </div>
                          </div>
                          <div class="accordion-item">
                            <h2 class="accordion-header">
                              <button class="accordion-button collapsed bg-white shadow-none" type="button"
                                data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseFour"
                                aria-expanded="false" aria-controls="panelsStayOpen-collapseFour">
                                <p class="accordion-text hotSaleText">Hot Sale</p>
                              </button>
                            </h2>
                            <div id="panelsStayOpen-collapseFour" class="accordion-collapse collapse">
                              <div class="accordion-body">
                                <div class="list-group align-items-center">
                                  <a href="#" class="list-group-item list-group">Ver todo Hombre</a>
                                  <a href="#" class="list-group-item list-group">Ver todo Mujer</a>
                                  <a href="#" class="list-group-item list-group">Ver todo Niños</a>
                                </div>
                              </div>
                            </div>
                          </div>
                  </li>
                </ul>
                <section class="container-fluid d-flex justify-content-center">
                  <div class="iconos-RRSS-nav container-fluid d-flex justify-content-center">
                    <div class="row">
                      <a class="iconos-RRSS-nav-texto" aria-current="page" href="#">¿Necesitas Ayuda?</a>
                    </div>
                  </div>
                </section>
                <div class="iconos-RRSS-nav w-100">
                  <div class="iconos-RRSS-nav-img container d-flex justify-content-center aling.align-items-center">
                    <a href="#"><img class="iconos-RRSS-nav-insta" src="./src/atomo/instagram.svg" width="23"
                        alt="Logo de Instagram"></a>
                    <a href="#"></a><img class="iconos-RRSS-nav-face" src="./src/atomo/facebook.svg" width="25"
                      alt="Logo de Facebook"></a>
                  </div>
                </div>
              </div>
            </div>
        </div>
        </nav>
      </div>
      <div class="logo-Zenith d-flex align-item-start justify-content-center col-4 mt-2">
        <img src="src/atomo/logo_zenith.svg" width="150" alt="Logo de Zenith">
      </div>
      <!--Barra de navegacion-->
      <!--Barra de Busqueda-->
      <div class="barraBusqueda container-fluid py-2 d-flex justify-content-center">
        <form class="d-flex col-11 justify-content-center" id="search-form">
          <input class="form-control mx-0" type="search" placeholder="Buscar calzado..." aria-label="Search"
            id="search-bar">
          <button class="btn btn-outline-success mx-0" type="button" id="search-button"><img
              src="/src/atomo/serch.svg"></button>
        </form>
      </div>
      <!--Barra de Busqueda-->
      <!-- CART -->
      <div class="itemDeCompra col-2 d-flex justify-content-center align-self-start justify-content-center mt-3 ml-2"
        data-bs-toggle="modal" data-bs-target="#cartModal">
        <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-bag"
          viewBox="0 0 16 16">
          <path
            d="M8 1a2.5 2.5 0 0 1 2.5 2.5V4h-5v-.5A2.5 2.5 0 0 1 8 1m3.5 3v-.5a3.5 3.5 0 1 0-7 0V4H1v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V4zM2 5h12v9a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1z" />
        </svg>
        <div class="cartCount"></div>
      </div>
      <!-- CART -->
    </div>
    <!-- MODAL -->
    <div class="modal" tabindex="-1" aria-labelledby="cartModal" id="cartModal">
      <div class="modal-dialog modal-fullscreen">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title">Resumen de compra</h1>
            <div class="itemDeCompra col-2 d-flex justify-content-center align-self-start justify-content-center mt-3 ml-2"
            data-bs-toggle="modal" data-bs-target="#cartModal">
            <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-bag"
              viewBox="0 0 16 16">
              <path
                d="M8 1a2.5 2.5 0 0 1 2.5 2.5V4h-5v-.5A2.5 2.5 0 0 1 8 1m3.5 3v-.5a3.5 3.5 0 1 0-7 0V4H1v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V4zM2 5h12v9a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1z" />
            </svg>
            <div class="cartCount"></div>
          </div>
            <!-- <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button> -->
          </div>
          <div class="modal-body">
            <div id='cart-items-conteiner'>
              <!-- <div class="cart-item" id="cart-item"></div> -->
            </div>

          </div>
          <div class="accordion" id="accordionPanelsStayOpenExample">
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button bg-white collapsed shadow-none" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseOne"aria-expanded="false" aria-controls="panelsStayOpen-collapseOne">
                  <h1 class="accordion-text">Datos de envío a domicilio</h1>
                </button>
              </h2>
              <div id="panelsStayOpen-collapseOne" class="accordion-collapse collapse">
                <div class="accordion-body">
                  <div class="input-div">
                    <h2>Datos del comprador:</h2>
                    <input type="text" placeholder="Nombre">
                    <input type="text" placeholder="Apellido">
                    <input type="text" placeholder="Correo electrónico">
                    <h2>Datos de envío:</h2>
                    <input type="text" placeholder="Direccion">
                    <input type="text" placeholder="Casa, departamento (opcional)">
                    <input type="text" placeholder="Localidad">
                    <input type="text" placeholder="Codigo postal">
                    <input type="text" placeholder="Descripcion (opcional)">
                  </div>
                </div>
              </div>
            </div>
              </div>
          <div id="resumenDeCuenta"></div>
          <div class="modal-footer"> 
            <button type="button" id="btn-cart-close" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
            <button type="button" id="botonFinal" class="btn ">Finalizar compra</button>
          </div>
        </div>
      </div>
    </div>
    <!-- MODAL -->
    <!-- CARROUSEL -->
    <section class="carrousel">
      <div id="carouselExampleAutoplaying" class="carousel slide carrousel-div" data-bs-ride="carousel">
        <div class="carousel-inner">
          <div class="carousel-item active">
            <img
              src="src/images/Group 1.png"
              class="d-block w-100 carrousel-img" alt="..." />
          </div>
          <div class="carousel-item">
            <img src="src/images/image 13.png"
              class="d-block w-100 carrousel-img" alt="..." />
          </div>
          <div class="carousel-item">
            <img
              src="src/images/image 14.png"
              class="d-block w-100 carrousel-img" alt="..." />
          </div>
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleAutoplaying"
          data-bs-slide="prev">
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleAutoplaying"
          data-bs-slide="next">
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Next</span>
        </button>
      </div>
    </section>
    <!-- CARROUSEL -->
  </header>
  <main>
    <section class="nav-bajo-item container-fluid row button-container d-flex justify-content-center ">
      <div class="col d-flex justify-content-center p-0">
        <button id="nav-bajo-banner"
          class="btn btn-outline-secondary btn-block text-center d-flex px-0 py-12">Todos</button>
      </div>
      <div class="col d-flex justify-content-center p-0">
        <button id="nav-bajo-banner"
          class="btn btn-outline-secondary btn-block text-center d-flex px-0 py-12">Hombre</button>
      </div>
      <div class="col d-flex justify-content-center p-0">
        <button id="nav-bajo-banner"
          class="btn btn-outline-secondary btn-block text-center d-flex px-0 py-12">Mujer</button>
      </div>
      <div class="col d-flex justify-content-center p-0">
        <button id="nav-bajo-banner"
          class="btn btn-outline-secondary btn-block text-center d-flex px-0 py-12">Niño</button>
      </div>
    </section>
    <section">
      <div class="sugerencias container">Los más vendidos</div>
      </section>
      <div id="loader" style="display:none;">Cargando...</div>
      <section>
        <div id="card-container-1" class="card-container"></div>
      </section>
      <section>
        <div class="publicidad">
          <img src="src/images/PUBLICIDAD 1 1.png" alt="publicidad">
          <img src="src/images/VERSION BLACK 1.png" alt="publicidad">
        </div>
      </section>
      <section>
        <div class="sugerencias container">Aprovecha estos descuentos</div>
        <div id="card-container-2" class="card-container"></div>
      </section>
      <button id="back-to-top"><img src="../src/atomo/flecha arriba.png" alt="↑"></button>
  </main>
  <!-- Footer section Begin -->
  <footer class="footer py-2">
    <div class="container">
      <div class="row">
          <div class="footer-widget my-1 py-2">
            <div class="accordion" id="accordionPanelsStayOpenExample">
              <div class="accordion-item">
                <h2 class="accordion-header">
                  <button class="accordion-button accordion-buttonFooter collapsed shadow-none accordionFooter" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseSix" aria-expanded="true" aria-controls="panelsStayOpen-collapseSix">
                    <p class="accordion-textFooter">¿Necesitas Ayuda?</p>
                  </button>
                </h2>
                <div id="panelsStayOpen-collapseSix" class="accordion-collapse collapse show">
                </div>
              </div>
              <div class="accordion" id="accordionPanelsStayOpenExample">
                <div class="accordion-item">
                  <h2 class="accordion-header">
                    <button class="accordion-button accordion-buttonFooter collapsed shadow-none accordionFooter" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseSeven" aria-expanded="true" aria-controls="panelsStayOpen-collapseSeven">
                      <p class="accordion-textFooter">Información</p>
                    </button>
                  </h2>
                  <div id="panelsStayOpen-collapseSeven" class="accordion-collapse collapse show">
                  </div>
                </div>
        <div class="container ">
          <div class="footer-widget">
            <ul>
              <li><a href="./screens/quienessomos.html">Quienes somos?</a></li>
              <li><a href="#">Politica de privacidad</a></li>
              <li><a href="#">Términos y condiciones</a></li>
              <li><a href="#">Politica de cambio y devoluciones</a></li>
              <li><a href="#">Envios a domicilio y plazos de entrega</a></li>
            </ul>
          </div>
        </div>
          <div class="footer-widget">
            <h6 class="contactoFooter pb-4 m-0"><a href="contacto.html">Contacto</a></h6>
            <div class="footer-newslatter container d-flex justify-content-center">
              <p class="suscribeteFooter">Suscríbete para recibir nuestras</p>
            </div>
            <div class="footer-newslatter container d-flex justify-content-center">
              <p class="suscribeteFooter pb-3">ofertas y descuentos</p>
            </div>
            <div class="container-fluid d-flex flex-row justify-content-center px-0">
              <form action="#">
                <div class="input-group">
                  <input class="inputFormFooter form-controlFooter" type="text" placeholder="Ingresa tu correo electrónico aquí">
                  <button class="btn btn-outline-successFooter mx-0" type="submit">
                    <img class="imagenForm" src="../src/images/botonimagenadelante.png">
                  </button>
                </div>
              </form>
            </div>
          </div>
          <div class="container d-flex justify-content-center">
            <p>Siguenos en nuestras redes:</p>
          </div>
          <div class="iconos-RRSS-nav-Footer w-100"> 
            <div class="iconos-RRSS-nav-img-Footer container d-flex justify-content-center align-items-center">
              <a href="#"><img class="iconos-RRSS-nav-insta" src="./src/atomo/facebookfooter.svg" width="24" alt="Logo de Facebook"></a>
              <a href="#"></a><img class="iconos-RRSS-nav-face mx-3" src="./src/atomo/instagramfooter.svg" width="25" alt="Logo de Instagram"></a>
            </div>
          </div>
            <div class="col-lg-3 offset-lg-1 col-md-6 col-sm-6">
              <div class="footer-newslatter">
              </div>
            </div>
        </div>
      </div>
    </div>
    <div class="container d-flex justify-content-center">
      <div class="col-lg-12 text-center">
        <div class="footer-copyright-text my-2">
          <p>&copy; 2024. Todos los derechos reservados
        </div>
      </div>
    </div>
    </div>
  </footer>
</body>
<script>
  window.onload = function() {
    let cart = JSON.parse(localStorage.getItem('cart')) || [];
    const cartCount = document.getElementById("cartCount")
    cartCount.innerHTML = cart.reduce((acc, item) => acc + item.quantity, 0);    
};

window.addEventListener('DOMContentLoaded', loadCartFromLocalStorage);

const productId = new URL(document.location.toString()).searchParams.get('productId');
let cart = JSON.parse(localStorage.getItem('cart')) || [];
let selectedColor = null;
let selectedTalle = null;
const resumenDeCuenta = document.getElementById('resumenDeCuenta');
resumenDeCuenta.classList.add('resumen');
const cartItemsDiv = document.getElementById('cart-items-conteiner');
const cartCount = document.querySelectorAll(".cartCount");

// Update cart count initially
updateCartCount(cart);
updateTotalPrice(cart);

window.addEventListener('DOMContentLoaded', loadCartFromLocalStorage);

function loadCartFromLocalStorage() {
  if (cart.length > 0) {
    cartItemsDiv.innerHTML = ''; // Clear existing items
    cart.forEach((product) => {
      const cartItemHTML = generateCartItemHTML(product);
      cartItemsDiv.appendChild(cartItemHTML);
    });
  }
  updateTotalPrice(cart);
}

function removeFromCart(productId, color, talle) {
    const productIndex = cart.findIndex(item => item.id === productId && item.selectedColor === color && item.selectedTalle === talle);
    if (productIndex !== -1) {
      if (cart[productIndex].quantity > 1) {
        cart[productIndex].quantity--;
        document.querySelector(`.cart-item[data-id='${productId}'][data-color='${color}'][data-talle='${talle}'] .item-quantity`).textContent = `Cantidad: ${cart[productIndex].quantity}`;
      } else {
        cart.splice(productIndex, 1);
        document.querySelector(`.cart-item[data-id='${productId}'][data-color='${color}'][data-talle='${talle}']`).remove();
      }
      localStorage.setItem('cart', JSON.stringify(cart));
      updateCartCount(cart);
      updateTotalPrice(cart);
    }
  }

  function generateCartItemHTML(product) {
    if (product) {
      const cartItem = document.createElement('div');
      cartItem.classList.add('cart-item');
      cartItem.dataset.id = product.id;
      cartItem.dataset.color = product.selectedColor;
      cartItem.dataset.talle = product.selectedTalle;

      const removeButton = document.createElement('button');
      removeButton.classList.add('deleteButton');
      const deleteIcon = '<img src="../src/atomo/papelera.svg" alt="eliminar">';
      removeButton.innerHTML = deleteIcon;
      cartItem.appendChild(removeButton);
      removeButton.addEventListener('click', () => {
        removeFromCart(product.id, product.selectedColor, product.selectedTalle);
      });

      const image = document.createElement('img');
      image.classList.add('product-cart-img');
      image.src = product.image1;
      cartItem.appendChild(image);

      const itemName = document.createElement('span');
      itemName.classList.add('item-name');
      itemName.textContent = product.nombre;

      const itemQuantity = document.createElement('span');
      itemQuantity.textContent = `Cantidad: ${product.quantity}`;
      itemQuantity.classList.add('item-quantity');

      const dataDiv = document.createElement('div');
      dataDiv.classList.add('data-div');
      dataDiv.appendChild(itemName);
      dataDiv.appendChild(itemQuantity);

      // Añadimos color y talle seleccionados
      if (product.selectedColor) {
        const itemColor = document.createElement('span');
        itemColor.textContent = `Color: ${product.selectedColor}`;
        dataDiv.appendChild(itemColor);
      }

      if (product.selectedTalle) {
        const itemTalle = document.createElement('span');
        itemTalle.textContent = `Talle: ${product.selectedTalle}`;
        dataDiv.appendChild(itemTalle);
      }

      cartItem.appendChild(dataDiv);

      const itemPrice = document.createElement('span');
      itemPrice.textContent = `$${product.precio}`;
      itemPrice.classList.add('item-price');
      cartItem.appendChild(itemPrice);

      return cartItem;
    }
  }

function updateCartCount(cart) {
  const totalQuantity = cart.reduce((acc, product) => acc + product.quantity, 0);
  if (cartCount) {
    cartCount.forEach(element => {
      element.innerHTML = totalQuantity;
    });
  } else {
    console.warn("Cart count element (cartCount) not found!");
  }
}

function updateTotalPrice(cart) {
    const totalPrice = cart.reduce((acc, product) => acc + product.precio * product.quantity, 0);
    resumenDeCuenta.innerHTML = `Total: $${totalPrice.toFixed(2)}`;
  }

</script>
<script src="./scripts/script.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

</html>